<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>AdminLTE 3 | Dashboard 3</title>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
    <!-- IonIcons -->
    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/adminlte.min.css">
    <!-- Google Font: Source Sans Pro -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

</head>
<!--
BODY TAG OPTIONS:
=================
Apply one or more of the following classes to to the body tag
to get the desired effect
|---------------------------------------------------------|
|LAYOUT OPTIONS | sidebar-collapse                        |
|               | sidebar-mini                            |
|---------------------------------------------------------|
-->

<body class="hold-transition layout-boxed sidebar-mini">
    <div class="wrapper">

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1 class="m-0 text-dark">Anasayfa</h1>
                        </div><!-- /.col -->
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a href="#">SUCO</a></li>
                                <li class="breadcrumb-item active">Anasayfa</li>
                            </ol>
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.container-fluid -->
            </div>
            <!-- /.content-header -->

            <!-- Main content -->
            <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12 offset-md-2  col-md-8">
                            <div class="card card-primary">
                                <div class="card-header">
                                    <h3 class="card-title">Payla≈üƒ±m</h3>
                                </div>
                                <!-- /.card-header -->
                                <div class="card-body">
                                    <form role="form" action="" id="formPost" enctype="multipart/form-data"
                                        method="POST">
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <!-- textarea -->
                                                <div class="form-group">
                                                    <div id="hisAlani"></div>
                                                    <textarea id="metin" class="form-control" rows="5"
                                                        placeholder="Payla≈ü ..."></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div id="carousel-div" class="col-md-10 offset-1 mb-2">
                                                <div id="carouselExampleIndicators" class="carousel slide"
                                                    data-ride="carousel">
                                                    <ol class="carousel-indicators">
                                                        <!-- RESƒ∞M butonu -->
                                                    </ol>
                                                    <div class="carousel-inner">
                                                        <!-- Resimler buraya ekleniyor -->
                                                    </div>
                                                    <a class="carousel-control-prev" href="#carouselExampleIndicators"
                                                        role="button" data-slide="prev">
                                                        <span class="carousel-control-prev-icon"
                                                            aria-hidden="true"></span>
                                                        <span class="sr-only">Previous</span>
                                                    </a>
                                                    <a class="carousel-control-next" href="#carouselExampleIndicators"
                                                        role="button" data-slide="next">
                                                        <span class="carousel-control-next-icon"
                                                            aria-hidden="true"></span>
                                                        <span class="sr-only">Next</span>
                                                    </a>
                                                </div>

                                            </div>
                                            <div class="col-1">
                                                <div id="resimVazgec" style="display: none;" class="badge badge-dark">x
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="row">
                                            <div class="col-5">
                                                <i class="fas fa-users ml-3" id="kitleSec"></i>
                                                <ul id="kitleler"
                                                    style="position: absolute;z-index: 99999;display: none;"
                                                    class="list-group list-group-item-action active col-md-9">
                                                    <li kitle="herkes" class="list-group-item kitle">
                                                        Herkese A√ßƒ±k
                                                    </li>
                                                    <li kitle="arkadas" class="list-group-item kitle">
                                                        Arkada≈ülar
                                                    </li>
                                                </ul>
                                                <i class="fas text-warning fa-smile ml-3 " id="duyguSec"></i>
                                                <i class="fas fa-image ml-3" id="resimSec"></i>
                                                <div id="duygular"
                                                    style="position: absolute;z-index: 99999;display: none;"
                                                    class="col-md-12">
                                                    <div class="card card-outline card-warning">
                                                        <div class="card-body">
                                                            <ul class="list-group list-group-item-action active">
                                                                <button duygu="0"
                                                                    class="list-group-item his list-group-item-action">Mutlu
                                                                    üòÅ</button>
                                                                <button duygu="1"
                                                                    class="list-group-item his list-group-item-action">Mutsuz
                                                                    ‚òπ </button>
                                                                <button duygu="2"
                                                                    class="list-group-item his list-group-item-action">Endi≈üeliüòü
                                                                </button>
                                                                <button duygu="3"
                                                                    class="list-group-item his list-group-item-action">√áƒ±lgƒ±n
                                                                    ü§™ </button>
                                                                <button duygu="4"
                                                                    class="list-group-item his list-group-item-action">Hasta
                                                                    ü§¢ </button>
                                                                <button duygu="5"
                                                                    class="list-group-item his list-group-item-action">G√ºlmekten
                                                                    Kƒ±rƒ±lmƒ±≈ü ü§£ </button>
                                                                <button duygu="6"
                                                                    class="list-group-item his list-group-item-action">Sinirli
                                                                    üò° </button>
                                                                <button duygu="7"
                                                                    class="list-group-item his list-group-item-action">Keyfi
                                                                    Yerinde ü§ó </button>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="file" multiple style="display: none;" name=""
                                                    id="resimler">
                                            </div>
                                            <button id="paylas" class="btn btn-primary ml-auto">Payla≈ü</button>
                                        </div>
                                        <script>
                                            let resimSec = document.getElementById("resimSec"),
                                                inputElement = document.getElementById("resimler"),
                                                metin = document.getElementById("metin"),
                                                duyguSec = document.getElementById('duyguSec'),
                                                duygularList = document.getElementById('duygular'),
                                                duygu = "",
                                                duyguButonlari = Array.from(document.getElementsByClassName("his")),
                                                kitleButonlari = Array.from(document.getElementsByClassName("kitle")),
                                                kitleler = document.getElementById("kitleler"),
                                                kitleSec = document.getElementById("kitleSec"),
                                                arkadaslarMi = true,
                                                paylas = document.getElementById("paylas");
                                            formPost = document.getElementById("formPost");


                                            //Payla≈ü Butonuna bastƒ±ktan sonrasƒ±
                                            paylas.addEventListener("click", (e) => {
                                                e.preventDefault();
                                                let formData = new FormData();

                                                formData.append('text', metin.value);
                                                for (let i = 0; i < inputElement.files.length; i++) {
                                                    formData.append("image", inputElement.files[i]);
                                                }
                                                formData.append("duygu", duygu);
                                                formData.append("kitle", (() => { if (arkadaslarMi) return 1; else return 0; })());
                                                formData.append("token", localStorage.getItem("token"));
                                                // console.log(formData.get("text"), formData.get("image"), formData.get("duygu"), formData.get("kitle"), formData.get("token"));

                                                fetch("http://localhost:85/post/publish", {
                                                    method: "POST",
                                                    body: formData,
                                                }).then((res) => res.json()).then((x) => { location.reload(); e.preventDefault(); });

                                                return false;
                                            });



                                            // Resim se√ßildiƒüinde g√∂r√ºnt√ºlenmesi ve resim/resimlerin se√ßilmekten vazge√ßilmesi
                                            let carouselInner = document.getElementsByClassName("carousel-inner")[0];
                                            let carouselIndicators = document.getElementsByClassName("carousel-indicators")[0];
                                            resimSec.addEventListener("click", () => {
                                                inputElement.click();
                                                inputElement.onchange = function () {
                                                    // RESƒ∞M G√ñSTERƒ∞LECEK
                                                    let resimler = Array.from(inputElement.files);
                                                    let addActive = false;
                                                    resimler.forEach((resim, index) => {
                                                        let reader = new FileReader();
                                                        reader.readAsDataURL(resim);
                                                        reader.addEventListener("load", () => {
                                                            carouselInner.innerHTML += ` <div class="carousel-item ${(() => { if (!addActive) { return "active" } })()}">
                                                                <img id="seciliResim" style="height:35vh" class="d-block w-100"
                                                                    src="${reader.result}"
                                                                    alt="First slide">
                                                            </div>`;
                                                            carouselIndicators.innerHTML += ` <li data-target="#carouselExampleIndicators" data-slide-to="${index}"
                                                            class="${(() => { if (!addActive) { addActive = true; return 'active' } })()}"></li>`;
                                                        });
                                                    });
                                                    let resimVazgec = document.getElementById("resimVazgec");
                                                    resimVazgec.style.display = "block";
                                                    resimVazgec.addEventListener("click", () => {
                                                        resimVazgec.style.display = "none";
                                                        inputElement.value = "";
                                                        carouselInner.innerHTML = "";
                                                        carouselIndicators.innerHTML = "";
                                                    });
                                                }
                                            });

                                            //Duygu ve Kitle Se√ßenekleri g√∂r√ºnt√ºleme
                                            duyguSec.addEventListener("click", () => {
                                                if (duygularList.style.display == "block") duygularList.style.display = "none";
                                                else duygularList.style.display = "block";
                                            });
                                            kitleSec.addEventListener("click", () => {
                                                if (kitleler.style.display == "block") kitleler.style.display = "none";
                                                else kitleler.style.display = "block";
                                            });
                                            //Duygu ve Kitle Se√ßimi (click) olaylarƒ±
                                            duyguButonlari.forEach((buton) => {
                                                buton.addEventListener("click", (e) => {
                                                    e.preventDefault();
                                                    duygularList.style.display = "none";
                                                    duygu = e.target.getAttribute("duygu")
                                                    document.getElementById("hisAlani").innerHTML = `<div class="badge badge-primary">${duygu} Hissediyor  <div id="duyguSil" class="badge badge-danger">x</div> </div> `;
                                                    document.getElementById("duyguSil").addEventListener('click', () => {
                                                        document.getElementById("hisAlani").innerHTML = "";
                                                    });
                                                });
                                            });
                                            kitleButonlari.forEach((buton) => {
                                                buton.addEventListener("click", (e) => {

                                                    kitleler.style.display = "none";
                                                    kitle = e.target.getAttribute("kitle");
                                                    if (kitle === "arkadas") {
                                                        kitleSec.classList.remove("fa-globe")
                                                        kitleSec.classList.add("fa-users")
                                                        arkadaslarMi = true;
                                                    } else {
                                                        kitleSec.classList.remove("fa-users")
                                                        kitleSec.classList.add("fa-globe")
                                                        arkadaslarMi = false;
                                                    }
                                                });
                                            });
                                        </script>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="loading" class="col-12 text-center">
                        <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                        <h3>Y√ºkleniyor...</h3>
                    </div>
                    <div id="postsPlace" class="row">

                    </div>
                    <!-- /.row -->

                </div>
                <!-- /.container-fluid -->
            </div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->


        <!-- Main Footer -->
        <footer class="main-footer">
            <strong>Copyright &copy; 2019-2020 SUCO</a>.</strong>
            All rights reserved.
            <div class="float-right d-none d-sm-inline-block">
                <b>Version</b> 1.0.0
            </div>
        </footer>
    </div>
    <!-- ./wrapper -->
    <!-- Chat friends -->
    <div id="chatDiv">

    </div>
    <!-- /chat friends -->
    <!-- REQUIRED SCRIPTS -->
    <script src="http://localhost:84/socket.io/socket.io.js"></script>
    <script type="module" src="app.js"></script>
    <!-- jQuery -->
    <script src="plugins/jquery/jquery.min.js"></script>
    <!-- jQuery UI -->
    <script src="plugins/jquery-ui/jquery-ui.min.js"></script>
    <!-- Ekko Lightbox -->
    <script src="plugins/ekko-lightbox/ekko-lightbox.min.js"></script>
    <!-- Bootstrap -->
    <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE -->
    <script src="dist/js/adminlte.js"></script>
    <!-- OPTIONAL SCRIPTS -->

    <script src="dist/js/demo.js"></script>
    <script>
        $(function () {
            $(document).on('click', '[data-toggle="lightbox"]', function (event) {
                event.preventDefault();
                $(this).ekkoLightbox({
                    alwaysShowClose: true
                });
            });
        })
    </script>
</body>

</html>